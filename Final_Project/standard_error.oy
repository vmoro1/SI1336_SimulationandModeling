#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Jan  1 14:54:45 2021

@author: viggomoro
"""
# Standard error för v_max = {1, 2, 3} då densiteten är sådan att maximal flow 
# rate erhålls, dvs. 25, 40 respelktive 52 vilar
import matplotlib.pyplot as plt
import numpy as np

simulations1 = [25,
 50,
 75,
 100,
 125,
 150,
 175,
 200,
 225,
 250,
 275,
 300,
 325,
 350,
 375,
 400,
 425,
 450,
 475,
 500,
 525,
 550,
 575,
 600,
 625,
 650,
 675,
 700,
 725,
 750,
 775,
 800,
 825,
 850,
 875,
 900,
 925,
 950,
 975,
 1000,
 1025,
 1050,
 1075,
 1100,
 1125,
 1150,
 1175,
 1200,
 1225,
 1250,
 1275,
 1300,
 1325,
 1350,
 1375,
 1400,
 1425,
 1450,
 1475,
 1500,
 1525,
 1550,
 1575,
 1600,
 1625,
 1650,
 1675,
 1700,
 1725,
 1750,
 1775,
 1800,
 1825,
 1850,
 1875,
 1900,
 1925,
 1950,
 1975,
 2000,
 2025,
 2050,
 2075,
 2100,
 2125,
 2150,
 2175,
 2200,
 2225,
 2250,
 2275,
 2300,
 2325,
 2350,
 2375,
 2400,
 2425,
 2450,
 2475,
 2500,
 2525,
 2550,
 2575,
 2600,
 2625,
 2650,
 2675,
 2700,
 2725,
 2750,
 2775,
 2800,
 2825,
 2850,
 2875,
 2900,
 2925,
 2950,
 2975,
 3000,
 3025,
 3050,
 3075,
 3100]
stan_err1 = [0.010762899237658968,
 0.007467152559506118,
 0.005796467807125218,
 0.0048279907776936516,
 0.004253247715456068,
 0.0039046197231868145,
 0.0035713668303366045,
 0.0032728823373243724,
 0.003170877178499468,
 0.0029673197241587438,
 0.0028899636620601287,
 0.002735716936598272,
 0.0026469002238087374,
 0.0025594134173885833,
 0.0024994259590508344,
 0.002413989096577694,
 0.0023347979746768948,
 0.0022567230251351635,
 0.002205462724114841,
 0.002128368554882077,
 0.002057587092064171,
 0.001994950044122411,
 0.00195069799318044,
 0.0019081948454414109,
 0.0018482330855337317,
 0.0018286475894148486,
 0.0017848399859783427,
 0.0017549090295577428,
 0.0017099127398697497,
 0.001705922456787362,
 0.0016630816899625527,
 0.0016279952178328437,
 0.0016111082121059996,
 0.0015892260780216902,
 0.001565500375525152,
 0.0015428440495271177,
 0.0015315418275072192,
 0.0015102407082251486,
 0.0014944885812052944,
 0.001471392740432206,
 0.001445936530737802,
 0.0014341737712720896,
 0.0014142283466090227,
 0.001407122964353266,
 0.001390609919859401,
 0.0013769671280944701,
 0.0013560235359417062,
 0.0013406491504360549,
 0.0013251937323125174,
 0.0013132267888217568,
 0.001302538310825667,
 0.001287174579932264,
 0.0012726983472174575,
 0.0012631442145264492,
 0.001247645634867684,
 0.0012352610801979642,
 0.0012235984029172974,
 0.001212146976394589,
 0.0012050702274968388,
 0.0011914422698481226,
 0.001181338580216631,
 0.0011678440429945074,
 0.0011557552780490576,
 0.0011491409563064547,
 0.001138395336194624,
 0.0011305340272939697,
 0.0011203140666066868,
 0.001110079431443755,
 0.0011048896699505666,
 0.0010975619281869832,
 0.0010902725327903737,
 0.0010835916369414424,
 0.0010731847528837174,
 0.0010663293005740847,
 0.0010625434359603856,
 0.0010545549070565467,
 0.0010476916967429519,
 0.0010452816789531872,
 0.001039230606387351,
 0.0010317692687379072,
 0.0010253785559781316,
 0.0010183931943566495,
 0.0010163157090132431,
 0.0010072633259240935,
 0.0010043988563005616,
 0.0009978619605584532,
 0.000994764376855714,
 0.0009899990169619309,
 0.0009854608591305385,
 0.0009797783092616611,
 0.0009731028154061166,
 0.0009663709190013247,
 0.000960581118952259,
 0.0009539024012283027,
 0.0009513759819392845,
 0.0009470029651715574,
 0.0009448237846529325,
 0.0009388794890864329,
 0.0009315193507743822,
 0.000926426450824627,
 0.0009232549339532051,
 0.0009189688652057681,
 0.0009146292855266024,
 0.0009097229488393242,
 0.0009050581335462211,
 0.0009007049888534521,
 0.0008949264470073507,
 0.0008907417827659972,
 0.0008847566058024309,
 0.0008804534706828984,
 0.0008759796413225061,
 0.000871923704252602,
 0.0008672141713499216,
 0.0008633398990935504,
 0.0008571055037288198,
 0.0008542864898135854,
 0.0008515437382219987,
 0.0008494929894788935,
 0.0008457192328965498,
 0.0008422300592552647,
 0.0008384261287684499,
 0.0008354320240820041,
 0.0008334158319580478,
 0.0008289982047490075]

simulations2 = [25,
 50,
 75,
 100,
 125,
 150,
 175,
 200,
 225,
 250,
 275,
 300,
 325,
 350,
 375,
 400,
 425,
 450,
 475,
 500,
 525,
 550,
 575,
 600,
 625,
 650,
 675,
 700,
 725,
 750,
 775,
 800,
 825,
 850,
 875,
 900,
 925,
 950,
 975,
 1000,
 1025,
 1050,
 1075,
 1100,
 1125,
 1150,
 1175,
 1200,
 1225,
 1250,
 1275,
 1300,
 1325,
 1350,
 1375,
 1400,
 1425,
 1450,
 1475,
 1500,
 1525,
 1550,
 1575,
 1600,
 1625,
 1650,
 1675,
 1700,
 1725,
 1750,
 1775,
 1800,
 1825,
 1850,
 1875,
 1900,
 1925,
 1950,
 1975,
 2000,
 2025,
 2050,
 2075,
 2100,
 2125,
 2150,
 2175,
 2200,
 2225,
 2250,
 2275,
 2300,
 2325,
 2350,
 2375,
 2400,
 2425,
 2450,
 2475,
 2500,
 2525,
 2550,
 2575,
 2600,
 2625,
 2650,
 2675,
 2700,
 2725,
 2750,
 2775,
 2800,
 2825,
 2850,
 2875,
 2900,
 2925,
 2950,
 2975,
 3000,
 3025,
 3050,
 3075,
 3100]
stan_err2 = [0.018349205250727713,
 0.011445130860246346,
 0.009422992772617031,
 0.008171767114754175,
 0.007317662239073438,
 0.006534794157095939,
 0.006160788736134233,
 0.005839804498689539,
 0.005468473052952185,
 0.005244140122316524,
 0.004991282259543942,
 0.004728871921970775,
 0.004546733492098483,
 0.004444197538444454,
 0.004269140103024418,
 0.0040916620088892325,
 0.003938616293708789,
 0.0038152390990232907,
 0.0036831868125013823,
 0.003582764799315527,
 0.003451446770662729,
 0.0033375577260120848,
 0.0032646092780757273,
 0.0031937261699230136,
 0.003109398424792578,
 0.003023361235292666,
 0.002946257776744021,
 0.002902605599558913,
 0.0028692585983922984,
 0.0028170066102864,
 0.002757642141359719,
 0.0027198592873858337,
 0.002677551936121117,
 0.002626195555134597,
 0.002581773792304682,
 0.0025515328939213822,
 0.0025109709598462857,
 0.0024873287136463877,
 0.002464437472230856,
 0.0024456122790457646,
 0.0024124461939917775,
 0.0023955307288254443,
 0.00236954673843358,
 0.002344304201253466,
 0.0023236036726393735,
 0.0023056936691597313,
 0.002282365981923657,
 0.0022604435906648287,
 0.002243039477111477,
 0.0022097089034418898,
 0.0021827498556240676,
 0.0021499977886249963,
 0.002124064179605975,
 0.0021066120969565946,
 0.002084873940838772,
 0.0020739265282952216,
 0.0020526592432356834,
 0.0020255615885013136,
 0.0020047044627705146,
 0.0019850398605799633,
 0.0019643999793281545,
 0.00195526997515104,
 0.0019401615359402962,
 0.0019255600037843168,
 0.001909071706067662,
 0.0018963229120307471,
 0.001882069134432213,
 0.001870321688823468,
 0.001851256120149067,
 0.0018371840177273545,
 0.001823906136701599,
 0.0018162435570127878,
 0.0018018587384424083,
 0.0017877284147418161,
 0.0017735138715630576,
 0.001760172895270653,
 0.0017489153144581745,
 0.0017335173517411535,
 0.0017197942989488483,
 0.001709421835447808,
 0.0017017514063167776,
 0.0016858120073920382,
 0.0016758824537056762,
 0.0016726847688711662,
 0.0016616557565816792,
 0.0016523130832850003,
 0.0016459778385334608,
 0.0016359659784801756,
 0.0016235522209792394,
 0.0016170882238895152,
 0.0016072632572641948,
 0.0015966000312975283,
 0.001587409038825963,
 0.0015804483783852944,
 0.001571752545359775,
 0.0015633754089786904,
 0.0015534855946778576,
 0.001548751434093145,
 0.001541605007588669,
 0.0015341921717464011,
 0.0015281895169403255,
 0.0015237836856412258,
 0.0015171899039617836,
 0.0015097433865310377,
 0.0015058584487284588,
 0.0015000575531189154,
 0.0014951224459589666,
 0.0014881902905278096,
 0.001483685081237312,
 0.0014787172738192581,
 0.0014699049713882265,
 0.0014618102646393478,
 0.001453350324215005,
 0.0014463120708855485,
 0.0014386534194601778,
 0.0014304118456417508,
 0.0014267110196757482,
 0.0014199475762029555,
 0.001413665282129051,
 0.001408025310397936,
 0.0014004603517885007,
 0.0013921672757593105,
 0.0013845903284985656,
 0.0013780905386510693]

simulations3 = [25,
 50,
 75,
 100,
 125,
 150,
 175,
 200,
 225,
 250,
 275,
 300,
 325,
 350,
 375,
 400,
 425,
 450,
 475,
 500,
 525,
 550,
 575,
 600,
 625,
 650,
 675,
 700,
 725,
 750,
 775,
 800,
 825,
 850,
 875,
 900,
 925,
 950,
 975,
 1000,
 1025,
 1050,
 1075,
 1100,
 1125,
 1150,
 1175,
 1200,
 1225,
 1250,
 1275,
 1300,
 1325,
 1350,
 1375,
 1400,
 1425,
 1450,
 1475,
 1500,
 1525,
 1550,
 1575,
 1600,
 1625,
 1650,
 1675,
 1700,
 1725,
 1750,
 1775,
 1800,
 1825,
 1850,
 1875,
 1900,
 1925,
 1950,
 1975,
 2000,
 2025,
 2050,
 2075,
 2100,
 2125,
 2150,
 2175,
 2200,
 2225,
 2250,
 2275,
 2300,
 2325,
 2350,
 2375,
 2400,
 2425,
 2450,
 2475,
 2500,
 2525,
 2550,
 2575,
 2600,
 2625,
 2650,
 2675,
 2700,
 2725,
 2750,
 2775,
 2800,
 2825,
 2850,
 2875,
 2900,
 2925,
 2950,
 2975,
 3000,
 3025,
 3050,
 3075,
 3100]
stan_err3 = [0.014573034458661427,
 0.012269224814592828,
 0.009838870024721506,
 0.008617576588729935,
 0.007991556834882755,
 0.007754387755047469,
 0.007396388541238717,
 0.006983958647641021,
 0.00656707086554473,
 0.006380016995860581,
 0.006092878287983202,
 0.00581329221754251,
 0.005514386844335015,
 0.005283990602999884,
 0.005095440204088385,
 0.005025027587550052,
 0.00482588394389219,
 0.004704170016135445,
 0.004579140696498941,
 0.004491443657919415,
 0.004418422723713244,
 0.004298002001814926,
 0.0042098012747969525,
 0.004113088807242575,
 0.00402725972878295,
 0.0039419618571876385,
 0.0038426096565243976,
 0.003775915154561226,
 0.0037033286093867885,
 0.003618295661228293,
 0.0035571129157410644,
 0.003497822382644044,
 0.003441565763613296,
 0.003400709924140557,
 0.003352968694453909,
 0.003296369766856677,
 0.0032389663309557656,
 0.0032005686338193134,
 0.0031652984539487445,
 0.00310009486761102,
 0.0030779972020339354,
 0.0030487505276234647,
 0.003013309162290882,
 0.002983701581534543,
 0.002952161675163209,
 0.0029152477499862794,
 0.0028734620975591047,
 0.002852952524285837,
 0.002829340366640524,
 0.0028005685708898834,
 0.0027668717184672737,
 0.002750483511069585,
 0.0027139248868006793,
 0.0026842799943980035,
 0.002671748499081612,
 0.0026379822347016384,
 0.0026190578262564614,
 0.0025922988877858703,
 0.002568700811834229,
 0.0025516761820279996,
 0.0025298315857228805,
 0.002508310230446115,
 0.002485653363204508,
 0.0024670407107844645,
 0.0024504963778265386,
 0.002432048534312233,
 0.002413543196976073,
 0.002389390432174402,
 0.002379362577046415,
 0.0023613000045198105,
 0.002347304397701341,
 0.002328439108630811,
 0.002316252674561573,
 0.0022961936127203967,
 0.002277664820492096,
 0.002263302641935734,
 0.0022503045519657663,
 0.002233432805360315,
 0.0022203684384355447,
 0.002210154098828922,
 0.002195387635132823,
 0.002185721919576483,
 0.002178395936832299,
 0.002164876804496804,
 0.0021597464634291476,
 0.002153507404628744,
 0.0021429939901688386,
 0.002128826258729757,
 0.002116179073893587,
 0.002105266527371682,
 0.0020935819363283674,
 0.0020787134377670976,
 0.0020645696141721737,
 0.002049945982321527,
 0.002037955844506524,
 0.0020318085609716714,
 0.0020171075603762747,
 0.002012549258814431,
 0.0020050731688387334,
 0.0019919363654980742,
 0.0019810889022324556,
 0.0019740954737861374,
 0.0019672001519691266,
 0.001958072093122999,
 0.0019466949637805965,
 0.001934739829618577,
 0.0019204106543344696,
 0.0019150548626252317,
 0.0019069019632917247,
 0.001896169266525512,
 0.001886826711941724,
 0.001882828041122126,
 0.0018731254864886352,
 0.0018639747879264027,
 0.001857251544582508,
 0.0018507783590341847,
 0.0018424667096603412,
 0.0018323247853808842,
 0.0018225430855839247,
 0.001812922610710977,
 0.0018040306752093141,
 0.0017938957219988273,
 0.001784873307703843,
 0.0017760454508875365]

plt.figure()
plt.title('Standard error estimate when the number of is cars is such that\n maximum flow rate is achived. The different maximum velocities\n of the cars come with equal proportions from v_max = {1, 2, 3}.')
plt.xlabel('Number of simulations')
plt.ylabel('Standard error')
plt.plot(simulations1[1:], stan_err1[1:])
plt.plot(simulations2[1:], stan_err2[1:])
plt.plot(simulations3[1:], stan_err3[1:])
plt.legend(['One lane and 25 cars', 'Two lanes and 40 cars', 'Three lanes and 52 cars'])


# x = np.arange(1,10)
# y = 2 * x
# yerr = 0.1 * x
# plt.errorbar(x,y,yerr, fmt='-o')